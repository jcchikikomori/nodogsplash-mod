<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Welcome to $gatewayname</title>
	<link rel="stylesheet" type="text/css" href="/splash.css" />
</head>

<body>
	<section class="section">
		<div class="container has-text-centered">
			<div class="box" data-theme="light">
				<h1 class="title">Welcome!</h1><br />
				<p class="subtitle">
					You are about to connect to <strong>$gatewayname</strong>.<br />
					<!-- To get started, please tap or click "Continue" to proceed. -->
					To get started, please login to proceed.
				</p><br />
				<p class="notification has-text-danger">
					<strong>Warning:</strong> Whoever shares the <strong>WiFi password WITHOUT PERMISSION</strong>,
					whether through QR
					codes or using an app to leak it, is being <strong>monitored</strong> by the owner, who knows both
					your name and the
					name of the device you're using.

					$error_msg
				</p><br />
				<!-- <p class="notification has-text-danger">
					<strong>BABALA:</strong> Ang sinumang magbahagi ng WiFi password NG WALANG PAHINTULOT, kahit sa
					pamamagitan ng QR code o paggamit ng app para mag-leak, ay binabantayan ng may-ari, na alam ang
					iyong pangalan at ang pangalan ng iyong ginagamit na device.
				</p><br /> -->

				<form method="GET" action="$authaction">
					<input type="hidden" name="tok" value="$tok" />
					<input type="hidden" name="redir" value="$redir" />
					<input type="hidden" name="clientmac" value="$clientmac" id="clientmac" />
					<div class="field">
						<p class="control">
							<input class="input" type="text" placeholder="Enter provided Username" name="username"
								value="" size="12" maxlength="12" />
						</p>
					</div><br />
					<div class="field">
						<p class="control">
							<input class="input" type="password" placeholder="Enter Password" name="password" size="12"
								maxlength="12" />
						</p>
					</div><br />
					<p id="oui" class="notification" hidden>
						Are you using an <span id="manufacturer">Unspecified</span> device?<br />
						Here's my reminder again. DO NOT SHARE THE <strong>PASSWORD/QR OF THIS WIFI WITHOUT
							PERMISSION!</strong>
					</p>
					<button type="submit" class="button is-link is-fullwidth">Continue</button>
				</form>
			</div>
		</div>
	</section>

	<script type="text/javascript">
		var elSubmits = document.querySelectorAll('.button');
		var macObj = { mac: '', manufacturer: 'Unspecified' };
		for (var i = 0, l = elSubmits.length; i < l; i++) {
			var elSubmit = elSubmits[i];
			elSubmit.addEventListener('click', onclicksubmit);
		}
		function onclicksubmit(event) {
			var elSubmit = event.currentTarget;
			var classList = elSubmit.classList;
			if (classList.contains('is-loading')) {
				return;
			}
			classList.add('is-loading');
			setTimeout(function () {
				classList.remove('is-loading');
			}, ~~(Math.random() * 8000));
		}
		function parseMacAddress(mac) {
			// Regular expression to match MAC address
			var macRegex = /^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;
			// Check if MAC address matches the pattern
			if (macRegex.test(mac)) {
				// Extract the first 6 characters (the OUI) to determine the manufacturer
				var oui = mac.split(/[:-]/).slice(0, 3).join(':').toUpperCase();
				// Manufacturer lookup (you can expand this as needed)
				var manufacturers = {
					'00:23:EB': 'Samsung',
					'F4:02:28': 'Samsung (Phone)',
					'00:0A:27': 'Apple',
				};
				// Check if manufacturer exists in the lookup table
				if (manufacturers[oui]) {
					macObj = {
						mac: mac.toUpperCase(),
						manufacturer: manufacturers[oui]
					};
				} else {
					macObj = {
						mac: mac.toUpperCase(),
						manufacturer: 'Unspecified'
					};
				}
			} else {
				macObj = {
					error: 'Invalid MAC address format'
				};
			}
		}
		window.onload = function () {
			var _clientMac = document.getElementById("clientmac");
			var _ouiElem = document.getElementById("oui");
			var _manufElem = document.getElementById("manufacturer");
			var _clientMacVal = _clientMac.getAttribute("value");
			parseMacAddress(_clientMacVal);
			console.log(macObj);
			if (_manufElem) _manufElem.innerHTML = macObj.manufacturer;
			if (!macObj.error && macObj.manufacturer !== 'Unspecified') {
				_ouiElem.hidden = false;
				_manufElem.hidden = false;
			} else {
				_ouiElem.hidden = true;
				_manufElem.hidden = true;
			}
		};
	</script>
</body>

</html>